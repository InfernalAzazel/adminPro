import{l as H,r as a,a6 as v,a7 as B,a8 as L,a9 as A,z as u,j as r,B as G,D as U}from"./index-bca867e7.js";import{P as Z,a as z,B as K,M as N,b as V}from"./Table-da38efb5.js";import"./index-99662a6d.js";function X(){const{t}=H(),i=a.useRef(),p=a.useRef(),[D,R]=a.useState(),[x,o]=a.useState(),[y,d]=a.useState(!1),[l,I]=a.useState(!1),[C,m]=a.useState(!1),[h,S]=a.useState({current:1,pageSize:10,total:0}),{data:n,loading:q,runAsync:E,refresh:g}=v(),{runAsync:P}=B({manual:!0}),{runAsync:M}=L({manual:!0}),{runAsync:Y}=A({manual:!0});a.useEffect(()=>{R(n==null?void 0:n.data),S({...h,total:n==null?void 0:n.total,showSizeChanger:!0,showQuickJumper:!0})},[n]),a.useEffect(()=>{var e,s;l?(e=p.current)==null||e.resetFields():(s=p.current)==null||s.setFieldsValue(x)},[y]);const f=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:t("multipurpose.uid"),dataIndex:"uid",copyable:!0,ellipsis:!0},{title:t("pages.system.interface.name"),dataIndex:"name",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:t("multipurpose.rules.required")}]}},{title:t("pages.system.interface.group"),dataIndex:"group",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:t("multipurpose.rules.required")}]}},{title:t("pages.system.interface.path"),dataIndex:"path",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:t("multipurpose.rules.required")}]}},{title:t("pages.system.interface.method"),dataIndex:"method",copyable:!0,ellipsis:!0,valueEnum:{GET:{text:"GET",status:"Processing"},POST:{text:"POST",status:"Success"},PUT:{text:"PUT",status:"Warning"},DELETE:{text:"DELETE",status:"Error"}},formItemProps:{rules:[{required:!0,message:t("multipurpose.rules.required")}]}},{title:t("multipurpose.create_at"),key:"create_at",dataIndex:"create_at",valueType:"dateRange",search:{transform:e=>({startCreateTime:u(e[0],"YYYY-MM-DDTHH:mm:ss.SSS[Z]"),endCreateTime:u(e[1],"YYYY-MM-DDTHH:mm:ss.SSS[Z]")})},render:(e,s)=>u(s.create_at)},{title:t("multipurpose.update_at"),dataIndex:"update_at",valueType:"dateRange",search:{transform:e=>({startUpdateTime:u(e[0],"YYYY-MM-DDTHH:mm:ss.SSS[Z]"),endUpdateTime:u(e[1],"YYYY-MM-DDTHH:mm:ss.SSS[Z]")})},render:(e,s)=>u(s.update_at)},{title:t("multipurpose.operate"),valueType:"option",key:"option",fixed:"right",hideInDescriptions:!0,render:(e,s)=>[r.jsx("a",{onClick:()=>T(s,!1),children:t("multipurpose.edit")}),r.jsx("a",{className:"text-blueGray",onClick:()=>j(s),children:t("multipurpose.view")}),r.jsx(Z,{title:t("multipurpose.prompt"),description:t("multipurpose.isDel"),onConfirm:()=>O(s),okText:t("multipurpose.yes"),cancelText:t("multipurpose.no"),children:r.jsx("a",{className:"text-red",children:t("multipurpose.del")})})]}],w=f.map(e=>{const s=(c,k)=>e.dataIndex===c?{...e,...k}:e;return{...s("uid",{readonly:!0,hideInForm:l}),...s("create_at",{hideInForm:!0}),...s("update_at",{hideInForm:!0})}});function T(e,s=!0){var c;(c=i.current)==null||c.reload(),s?(I(!0),o(void 0)):(I(!1),o(e)),d(!0)}async function F(e){var s;l?await P(e):await M(e.uid,e),d(!1),g(),(s=i.current)==null||s.reload()}function j(e){o(e),m(!0)}async function O(e){var s;await Y(e.uid),g(),(s=i.current)==null||s.reload()}function _(){m(!1),o(void 0)}function b(){m(!1),o(void 0)}return r.jsxs(r.Fragment,{children:[r.jsx(z,{columns:f,actionRef:i,cardBordered:!0,loading:q,request:async e=>(await E(e),Promise.resolve({data:[],success:!0})),dataSource:D,options:{setting:{listsHeight:400}},pagination:h,onChange:e=>{S(e)},columnsState:{persistenceKey:"interfaceColumnsState",persistenceType:"localStorage"},rowKey:"uid",toolBarRender:()=>[r.jsx(G,{icon:r.jsx(U,{}),onClick:()=>T(),type:"primary",children:t("multipurpose.new")},"button")]}),r.jsx(K,{title:t(l?"multipurpose.new":"multipurpose.edit"),formRef:p,open:y,onOpenChange:d,layoutType:"ModalForm",columns:w,onFinish:F}),r.jsx(N,{title:t("multipurpose.view"),open:C,onOk:_,onCancel:b,children:r.jsx(V,{dataSource:x,bordered:!0,column:1,columns:f})})]})}export{X as default};
