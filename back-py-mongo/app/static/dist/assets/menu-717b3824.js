import{l as B,r as u,a2 as E,a3 as _,a4 as A,a5 as L,a0 as K,j as r,B as z,D as G}from"./index-bca867e7.js";import{P as H,a as N,B as J,M as Q,b as V}from"./Table-da38efb5.js";import"./index-99662a6d.js";function Y(){const{t:e}=B(),n=u.useRef(),p=u.useRef(),[q,R]=u.useState(),[f,o]=u.useState(),[y,d]=u.useState(!1),[i,x]=u.useState(!1),[C,m]=u.useState(!1),[g,h]=u.useState({current:1,pageSize:10,total:0}),{data:a,loading:M,runAsync:D}=E(),{runAsync:F}=_({manual:!0}),{runAsync:S}=A({manual:!0}),{runAsync:w}=L({manual:!0});u.useEffect(()=>{const{treeData:t}=K((a==null?void 0:a.data)||[]);R(t),h({...g,total:a==null?void 0:a.total,showSizeChanger:!0,showQuickJumper:!0})},[a]),u.useEffect(()=>{var t,s;i?(t=p.current)==null||t.resetFields():(s=p.current)==null||s.setFieldsValue(f)},[y]);const c=[{dataIndex:"index",valueType:"indexBorder",width:48},{title:e("multipurpose.uid"),dataIndex:"uid",copyable:!0,ellipsis:!0},{title:e("pages.system.menu.name"),dataIndex:"name",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:e("multipurpose.rules.required")}]}},{title:e("pages.system.menu.path"),dataIndex:"path",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:e("multipurpose.rules.required")}]}},{title:e("pages.system.menu.icon"),dataIndex:"icon",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:e("multipurpose.rules.required")}]}},{title:e("pages.system.menu.key"),dataIndex:"key",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:e("multipurpose.rules.required")}]}},{title:e("pages.system.menu.father"),dataIndex:"father",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:e("multipurpose.rules.required")}]}},{title:e("pages.system.menu.order"),dataIndex:"order",copyable:!0,ellipsis:!0,formItemProps:{rules:[{required:!0,message:e("multipurpose.rules.required")}]}},{title:e("multipurpose.create_at"),dataIndex:"create_at",valueType:"date",sorter:!0},{title:e("multipurpose.update_at"),dataIndex:"update_at",valueType:"date",sorter:!0},{title:e("multipurpose.operate"),valueType:"option",key:"option",fixed:"right",hideInDescriptions:!0,render:(t,s)=>[r.jsx("a",{onClick:()=>I(s,!1),children:e("multipurpose.edit")}),r.jsx("a",{className:"text-blueGray",onClick:()=>j(s),children:e("multipurpose.view")}),r.jsx(H,{title:e("multipurpose.prompt"),description:e("multipurpose.isDel"),onConfirm:()=>k(s),okText:e("multipurpose.yes"),cancelText:e("multipurpose.no"),children:r.jsx("a",{className:"text-red",children:e("multipurpose.del")})})]}],P=c.map(t=>{const s=(l,v)=>t.dataIndex===l?{...t,...v}:t;return{...s("uid",{readonly:!0,hideInForm:i}),...s("create_at",{hideInForm:!0}),...s("update_at",{hideInForm:!0})}});function I(t,s=!0){var l;(l=n.current)==null||l.reload(),s?(x(!0),o(void 0)):(x(!1),o(t)),d(!0)}async function b(t){var s;i?await F(t):await S(t.uid,t),d(!1),(s=n.current)==null||s.reload()}function j(t){o(t),m(!0)}async function k(t){var s;await w(t.uid),(s=n.current)==null||s.reload()}function T(){m(!1),o(void 0)}function O(){m(!1),o(void 0)}return r.jsxs(r.Fragment,{children:[r.jsx(N,{columns:c,actionRef:n,cardBordered:!0,loading:M,request:async t=>(await D(t),Promise.resolve({data:[],success:!0})),dataSource:q,options:{setting:{listsHeight:400}},pagination:g,onChange:t=>{h(t)},columnsState:{persistenceKey:"menuColumnsState",persistenceType:"localStorage"},rowKey:"uid",search:!1,dateFormatter:"string",toolBarRender:()=>[r.jsx(z,{icon:r.jsx(G,{}),onClick:()=>I(),type:"primary",children:e("multipurpose.new")},"button")]}),r.jsx(J,{title:e(i?"multipurpose.new":"multipurpose.edit"),formRef:p,open:y,onOpenChange:d,layoutType:"ModalForm",columns:P,onFinish:b}),r.jsx(Q,{title:e("multipurpose.view"),open:C,onOk:T,onCancel:O,children:r.jsx(V,{dataSource:f,bordered:!0,column:1,columns:c})})]})}export{Y as default};
